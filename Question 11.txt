-- GROUP BY

SELECT d.DeptName, COUNT(s.StudentID) AS TotalStudents FROM Department d JOIN Student s ON d.DeptID = s.DeptID GROUP BY d.DeptName;


-- HAVING
SELECT d.DeptName, COUNT(s.StudentID) AS TotalStudents FROM Department d JOIN Student s ON d.DeptID = s.DeptID GROUP BY d.DeptName HAVING COUNT(s.StudentID) > 2;


-- ANOTHER ONE
SELECT d.DeptName, AVG(c.Credits) AS AvgCredits FROM Department d JOIN Course c ON d.DeptID = c.DeptID GROUP BY d.DeptName;


-- VIEW

CREATE OR REPLACE VIEW StudentDepartment AS SELECT s.StudentID, s.Name, d.DeptName FROM Student s JOIN Department d ON s.DeptID = d.DeptID;


SELECT * FROM StudentDepartment;

DROP VIEW StudentDepartment;
